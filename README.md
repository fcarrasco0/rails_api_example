# About this Project
  
  ## Introduction
  This projects aims to be an api example to learn about Rails setup and development.
  It is a book's collection RESTfull api with some other routes for filtering specific groups of books and another for sort the search by a book's attribute. 
  More details up ahead.
   
  ## Dependencies

  Tool | Version Used
  ------------ | -------------
  Ruby | 2.7.0
  Ruby On Rails | 6.0.2.1

  ### gems used:

  * gem 'rspec-rails' (used for tests)
  * gem "factory_bot_rails" (used for tests)
  * gem 'faker' (used to create seeder)
  * gem 'json' (for treating some json files)
  * gem 'rswag' (for generating some documentation file with swagger.ui)

  **OBS: this last one is not implemented right in this project yet.**


  ### Tests
  The file used for some tests is found in spec/requests/books_spec.rb and spec/integration/books_spec.rb (this last one for generating the swagger doc with rswag)

  To execute the tests use the command `bundle exec rspec spec/requests/books_spec.rb` inside the project's folder.

  ### Database Seeder

  The seeder file can be found inside the **db** folder.
  This seeder has 5 records with author's name '*Stephen King*', 5 records  with publisher's name '*Dark Horse*' and 10 more records with random attributes generated by **Faker**.

  To run the seeder execute this command `rails db:seed` inside the project's folder after the `rails db:migrate` command has been run.

# Getting Started
In this project we will be working with a book collection and a book object.
The book object has the following attributes:
```json
 "book" {
	  "title": "Type: String",
	  "description": "Type: String",
	  "author": "Type: String",
	  "publisher": "Type: String",
	  "release_date": "type: yyyy-mm-dd",
	  "genre": "Type: String",
	  "edition": "Type: Integer",
	  "created_at": "type: timestamps",
	  "updated_at": "type: timestamps"
  }
```

## Running the project

Cloning the project on the selected file:
    `git clone https://github.com/fcarrasco0/rails_api_example.git`

Next go inside the folder and execute the following command:
`bundle install`

After the installation has finished run: `rails server` and you will be able to access the project via `http://localhost:3000` for local testings.

## Endpoints

#### Listing All Books
To list all books on the database simple make a request to: 
```
GET http://localhost:3000/api/v1/books
```
example of response:

```json
[
  {
    "id": 1,
    "title": "Surprised by Joy",
    "description": "Et dolor repudiandae corporis deleniti.",
    "author": "Stephen King",
    "publisher": "Etruscan Press",
    "genre": "Fantasy",
    "release_date": "2020-10-02",
    "edition": 2,
    "created_at": "2020-01-18T19:37:05.107Z",
    "updated_at": "2020-01-18T19:37:05.107Z"
  }, 
  ...
  {
    "id": 100,
    "title": "Oh! To be in England",
    "description": "Qui fuga accusamus error harum.",
    "author": "Stephen King",
    "publisher": "Voyager Books",
    "genre": "Tall tale",
    "release_date": "2020-12-31",
    "edition": 2,
    "created_at": "2020-01-18T19:37:05.409Z",
    "updated_at": "2020-01-18T19:37:05.409Z"
  }]
```

#### List All Books Sorted by Attribute
It is possible to get an ordered list sorted by all book's attributes except for `description`. 
To do so, use the following URI:
```
GET http://localhost:3000/api/v1/books/orderBy/attribute
```
example of response of `http://localhost:3000/api/v1/books/orderBy/title`:
```json
[
  {
    "id": 6,
    "title": "A Many-Splendoured Thing",
    "description": "Ipsum deleniti rem delectus adipisci.",
    "author": "Dr. Rubin Okuneva",
    "publisher": "Dark Horse",
    "genre": "Horror",
    "release_date": "2020-04-17",
    "edition": 4,
    "created_at": "2020-01-18T19:37:05.814Z",
    "updated_at": "2020-01-18T19:37:05.814Z"
  },
  {
    "id": 16,
    "title": "An Evil Cradling",
    "description": "Deleniti accusamus eum quisquam facilis.",
    "author": "Selina Kris MD",
    "publisher": "Sidgwick & Jackson",
    "genre": "Fiction narrative",
    "release_date": "2020-03-19",
    "edition": 5,
    "created_at": "2020-01-18T19:37:07.274Z",
    "updated_at": "2020-01-18T19:37:07.274Z"
  },
  {
    "id": 21,
    "title": "Dark Tower II",
    "description": null,
    "author": "Stephen King",
    "publisher": "Dark Horse",
    "genre": "Horror",
    "release_date": "2019-03-10",
    "edition": 1,
    "created_at": "2020-01-19T12:52:41.330Z",
    "updated_at": "2020-01-19T12:52:41.330Z"
  },
  ...
```

if you try to sort by description you will get the following response:
```json
{
  "message": "Description is not a valid request order.",
  "status": 400
}
```

#### Getting a single book
```
GET http://localhost:3000/api/v1/books/id
```

example of response of `http://localhost:3000/api/v1/books/1`:
```json
{
  "id": 1,
  "title": "Surprised by Joy",
  "description": "Et dolor repudiandae corporis deleniti.",
  "author": "Stephen King",
  "publisher": "Etruscan Press",
  "genre": "Fantasy",
  "release_date": "2020-10-02",
  "edition": 2,
  "created_at": "2020-01-18T19:37:05.107Z",
  "updated_at": "2020-01-18T19:37:05.107Z"
}
```
**You have to make the request with a valid id, otherwise you will get the following message:**

```json
{
  "error": "Book not found. Please check the id requested."
}
```

#### Creating a new book
To create a new book you must make a request to the following URI
```
POST http://localhost:3000/api/v1/books/
```
The body of the request must contain the book's attributes and respective values.
The **`'title', 'author', 'publisher' and 'genre'`** attributes are necessary to create a new book. Also the `'author'`need to be at least 5 characters long and `'title'` and `'genre'` need to have at least 3 characters.
Example of a valid request body:
```json
  {
	  "title": "Book Title",
	  "author": "Book Author",
	  "publisher": "Book Publisher",
	  "release_date": "yyyy-mm-dd",
	  "genre": "Book Genre",
	  "edition": 1
  }
```
The response for the successful request is:
```json
{
  "id": 23,
  "title": "Book Title",
  "description": null,
  "author": "Book Author",
  "publisher": "Book Publisher",
  "genre": "Book Genre",
  "release_date": null,
  "edition": 1,
  "created_at": "2020-01-19T22:34:21.948Z",
  "updated_at": "2020-01-19T22:34:21.948Z"
}
```

If any of the requisites for the request is not met, an error messsage will be received: 
```json
{
  "title": [
    "can't be blank",
    "is too short (minimum is 3 characters)"
  ],
  "author": [
    "can't be blank",
    "is too short (minimum is 5 characters)"
  ],
  "publisher": [
    "can't be blank"
  ],
  "genre": [
    "can't be blank",
    "is too short (minimum is 3 characters)"
  ]
}
```

#### Update Book

#### Delete Book

#### Get all authors, genres or publishers

#### List books grouped by author, genre or publisher
